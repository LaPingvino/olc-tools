javascript:(function(root,factory){if(typeof define==='function'&&define.amd){define(['b'],function(b){return(root.returnExportsGlobal=factory(b))})}else if(typeof module==='object'&&module.exports){module.exports=factory(require('b'))}else root.OpenLocationCode=factory()}(this,function(){var OpenLocationCode={};OpenLocationCode.CODE_PRECISION_NORMAL=10;OpenLocationCode.CODE_PRECISION_EXTRA=11;var SEPARATOR_='+',SEPARATOR_POSITION_=8,PADDING_CHARACTER_='0',CODE_ALPHABET_='23456789CFGHJMPQRVWX',ENCODING_BASE_=CODE_ALPHABET_.length,LATITUDE_MAX_=90,LONGITUDE_MAX_=180,MAX_DIGIT_COUNT=15,PAIR_CODE_LENGTH_=10,PAIR_RESOLUTIONS_=[20.0,1.0,.05,.0025,.000125],GRID_COLUMNS_=4,GRID_ROWS_=5,GRID_SIZE_DEGREES_=0.000125,MIN_TRIMMABLE_CODE_LEN_=6,getAlphabet=OpenLocationCode.getAlphabet=function(){return CODE_ALPHABET_},isValid=OpenLocationCode.isValid=function(code){if(!code||typeof code!=='string')return false;if(code.indexOf(SEPARATOR_)==-1)return false;if(code.indexOf(SEPARATOR_)!=code.lastIndexOf(SEPARATOR_))return false;if(code.length==1)return false;if(code.indexOf(SEPARATOR_)>SEPARATOR_POSITION_||code.indexOf(SEPARATOR_)%2==1)return false;if(code.indexOf(PADDING_CHARACTER_)>-1){if(code.indexOf(PADDING_CHARACTER_)==0)return false;var padMatch=code.match(new RegExp('('+PADDING_CHARACTER_+'+)','g'));if(padMatch.length>1||padMatch[0].length%2==1||padMatch[0].length>SEPARATOR_POSITION_-2)return false;if(code.charAt(code.length-1)!=SEPARATOR_)return false};if(code.length-code.indexOf(SEPARATOR_)-1==1)return false;code=code.replace(new RegExp('\\'+SEPARATOR_+'+'),'').replace(new RegExp(PADDING_CHARACTER_+'+'),'');for(var i=0,len=code.length;i<len;i++){var character=code.charAt(i).toUpperCase();if(character!=SEPARATOR_&&CODE_ALPHABET_.indexOf(character)==-1)return false};return true},isShort=OpenLocationCode.isShort=function(code){if(!isValid(code))return false;if(code.indexOf(SEPARATOR_)>=0&&code.indexOf(SEPARATOR_)<SEPARATOR_POSITION_)return true;return false},isFull=OpenLocationCode.isFull=function(code){if(!isValid(code))return false;if(isShort(code))return false;var firstLatValue=CODE_ALPHABET_.indexOf(code.charAt(0).toUpperCase())*ENCODING_BASE_;if(firstLatValue>=LATITUDE_MAX_*2)return false;if(code.length>1){var firstLngValue=CODE_ALPHABET_.indexOf(code.charAt(1).toUpperCase())*ENCODING_BASE_;if(firstLngValue>=LONGITUDE_MAX_*2)return false};return true},encode=OpenLocationCode.encode=function(latitude,longitude,codeLength){latitude=Number(latitude);longitude=Number(longitude);if(typeof codeLength=='undefined'){codeLength=OpenLocationCode.CODE_PRECISION_NORMAL}else codeLength=Math.min(MAX_DIGIT_COUNT,Number(codeLength));if(isNaN(latitude)||isNaN(longitude)||isNaN(codeLength))throw('ValueError: Parameters are not numbers');if(codeLength<2||(codeLength<PAIR_CODE_LENGTH_&&codeLength%2==1))throw'IllegalArgumentException: Invalid Open Location Code length';latitude=clipLatitude(latitude);longitude=normalizeLongitude(longitude);if(latitude==90)latitude=latitude-computeLatitudePrecision(codeLength);var code=encodePairs(latitude,longitude,Math.min(codeLength,PAIR_CODE_LENGTH_));if(codeLength>PAIR_CODE_LENGTH_)code+=encodeGrid(latitude,longitude,codeLength-PAIR_CODE_LENGTH_);return code},recoverNearest=OpenLocationCode.recoverNearest=function(shortCode,referenceLatitude,referenceLongitude){if(!isShort(shortCode))if(isFull(shortCode)){return shortCode}else throw'ValueError: Passed short code is not valid: '+shortCode;referenceLatitude=Number(referenceLatitude);referenceLongitude=Number(referenceLongitude);if(isNaN(referenceLatitude)||isNaN(referenceLongitude))throw('ValueError: Reference position are not numbers');referenceLatitude=clipLatitude(referenceLatitude);referenceLongitude=normalizeLongitude(referenceLongitude);shortCode=shortCode.toUpperCase();var paddingLength=SEPARATOR_POSITION_-shortCode.indexOf(SEPARATOR_),resolution=Math.pow(20,2-(paddingLength/2)),halfResolution=resolution/2.0,codeArea=decode(encode(referenceLatitude,referenceLongitude).substr(0,paddingLength)+shortCode);if(referenceLatitude+halfResolution<codeArea.latitudeCenter&&codeArea.latitudeCenter-resolution>=-LATITUDE_MAX_){codeArea.latitudeCenter-=resolution}else if(referenceLatitude-halfResolution>codeArea.latitudeCenter&&codeArea.latitudeCenter+resolution<=LATITUDE_MAX_)codeArea.latitudeCenter+=resolution;if(referenceLongitude+halfResolution<codeArea.longitudeCenter){codeArea.longitudeCenter-=resolution}else if(referenceLongitude-halfResolution>codeArea.longitudeCenter)codeArea.longitudeCenter+=resolution;return encode(codeArea.latitudeCenter,codeArea.longitudeCenter,codeArea.codeLength)},shorten=OpenLocationCode.shorten=function(code,latitude,longitude){if(!isFull(code))throw'ValueError: Passed code is not valid and full: '+code;if(code.indexOf(PADDING_CHARACTER_)!=-1)throw'ValueError: Cannot shorten padded codes: '+code;var code=code.toUpperCase(),codeArea=decode(code);if(codeArea.codeLength<MIN_TRIMMABLE_CODE_LEN_)throw'ValueError: Code length must be at least '+MIN_TRIMMABLE_CODE_LEN_;latitude=Number(latitude);longitude=Number(longitude);if(isNaN(latitude)||isNaN(longitude))throw('ValueError: Reference position are not numbers');latitude=clipLatitude(latitude);longitude=normalizeLongitude(longitude);var range=Math.max(Math.abs(codeArea.latitudeCenter-latitude),Math.abs(codeArea.longitudeCenter-longitude));for(var i=PAIR_RESOLUTIONS_.length-2;i>=1;i--)if(range<(PAIR_RESOLUTIONS_[i]*0.3))return code.substring((i+1)*2);return code},clipLatitude=function(latitude){return Math.min(90,Math.max(-90,latitude))},computeLatitudePrecision=function(codeLength){if(codeLength<=10)return Math.pow(20,Math.floor(codeLength/-2+2));return Math.pow(20,-3)/Math.pow(GRID_ROWS_,codeLength-10)},normalizeLongitude=function(longitude){while(longitude<-180)longitude=longitude+360;while(longitude>=180)longitude=longitude-360;return longitude},encodePairs=function(latitude,longitude,codeLength){var code='',adjustedLatitude=latitude+LATITUDE_MAX_,adjustedLongitude=longitude+LONGITUDE_MAX_,digitCount=0;while(digitCount<codeLength){var placeValue=PAIR_RESOLUTIONS_[Math.floor(digitCount/2)],digitValue=Math.floor(adjustedLatitude/placeValue);adjustedLatitude-=digitValue*placeValue;code+=CODE_ALPHABET_.charAt(digitValue);digitCount+=1;digitValue=Math.floor(adjustedLongitude/placeValue);adjustedLongitude-=digitValue*placeValue;code+=CODE_ALPHABET_.charAt(digitValue);digitCount+=1;if(digitCount==SEPARATOR_POSITION_&&digitCount<codeLength)code+=SEPARATOR_};if(code.length<SEPARATOR_POSITION_)code=code+Array(SEPARATOR_POSITION_-code.length+1).join(PADDING_CHARACTER_);if(code.length==SEPARATOR_POSITION_)code=code+SEPARATOR_;return code},encodeGrid=function(latitude,longitude,codeLength){var code='',latPlaceValue=GRID_SIZE_DEGREES_,lngPlaceValue=GRID_SIZE_DEGREES_;latitude+=LATITUDE_MAX_;longitude+=LONGITUDE_MAX_;latitude=latitude%1.0;longitude=longitude%1.0;var adjustedLatitude=latitude%latPlaceValue,adjustedLongitude=longitude%lngPlaceValue;for(var i=0;i<codeLength;i++){var row=Math.floor(adjustedLatitude/(latPlaceValue/GRID_ROWS_)),col=Math.floor(adjustedLongitude/(lngPlaceValue/GRID_COLUMNS_));latPlaceValue/=GRID_ROWS_;lngPlaceValue/=GRID_COLUMNS_;adjustedLatitude-=row*latPlaceValue;adjustedLongitude-=col*lngPlaceValue;code+=CODE_ALPHABET_.charAt(row*GRID_COLUMNS_+col)};return code},CodeArea=OpenLocationCode.CodeArea=function(latitudeLo,longitudeLo,latitudeHi,longitudeHi,codeLength){return new OpenLocationCode.CodeArea.fn.init(latitudeLo,longitudeLo,latitudeHi,longitudeHi,codeLength)};CodeArea.fn=CodeArea.prototype={init:function(latitudeLo,longitudeLo,latitudeHi,longitudeHi,codeLength){this.latitudeLo=latitudeLo;this.longitudeLo=longitudeLo;this.latitudeHi=latitudeHi;this.longitudeHi=longitudeHi;this.codeLength=codeLength;this.latitudeCenter=Math.min(latitudeLo+(latitudeHi-latitudeLo)/2,LATITUDE_MAX_);this.longitudeCenter=Math.min(longitudeLo+(longitudeHi-longitudeLo)/2,LONGITUDE_MAX_)}};CodeArea.fn.init.prototype=CodeArea.fn;return OpenLocationCode}));loc=location.href.match(/(1?[0-9])\/(-?[0-9]+\.?[0-9]*)\/(-?[0-9]+\.[0-9]*)/);zl=10;if(loc[1]==19)zl=11;if(loc[1]<14)zl=8;if(loc[1]<8)zl=6;if(loc[1]<5)zl=4;olc=OpenLocationCode.encode(loc[2],loc[3],zl);alert(olc)

javascript:(function(root,factory){if(typeof define==='function'&&define.amd){define(['b'],function(b){return(root.returnExportsGlobal=factory(b))})}else if(typeof module==='object'&&module.exports){module.exports=factory(require('b'))}else root.OpenLocationCode=factory()}(this,function(){var OpenLocationCode={};OpenLocationCode.CODE_PRECISION_NORMAL=10;OpenLocationCode.CODE_PRECISION_EXTRA=11;var SEPARATOR_='+',SEPARATOR_POSITION_=8,PADDING_CHARACTER_='0',CODE_ALPHABET_='23456789CFGHJMPQRVWX',ENCODING_BASE_=CODE_ALPHABET_.length,LATITUDE_MAX_=90,LONGITUDE_MAX_=180,MAX_DIGIT_COUNT=15,PAIR_CODE_LENGTH_=10,PAIR_RESOLUTIONS_=[20.0,1.0,.05,.0025,.000125],GRID_COLUMNS_=4,GRID_ROWS_=5,GRID_SIZE_DEGREES_=0.000125,MIN_TRIMMABLE_CODE_LEN_=6,getAlphabet=OpenLocationCode.getAlphabet=function(){return CODE_ALPHABET_},isValid=OpenLocationCode.isValid=function(code){if(!code||typeof code!=='string')return false;if(code.indexOf(SEPARATOR_)==-1)return false;if(code.indexOf(SEPARATOR_)!=code.lastIndexOf(SEPARATOR_))return false;if(code.length==1)return false;if(code.indexOf(SEPARATOR_)>SEPARATOR_POSITION_||code.indexOf(SEPARATOR_)%2==1)return false;if(code.indexOf(PADDING_CHARACTER_)>-1){if(code.indexOf(PADDING_CHARACTER_)==0)return false;var padMatch=code.match(new RegExp('('+PADDING_CHARACTER_+'+)','g'));if(padMatch.length>1||padMatch[0].length%2==1||padMatch[0].length>SEPARATOR_POSITION_-2)return false;if(code.charAt(code.length-1)!=SEPARATOR_)return false};if(code.length-code.indexOf(SEPARATOR_)-1==1)return false;code=code.replace(new RegExp('\\'+SEPARATOR_+'+'),'').replace(new RegExp(PADDING_CHARACTER_+'+'),'');for(var i=0,len=code.length;i<len;i++){var character=code.charAt(i).toUpperCase();if(character!=SEPARATOR_&&CODE_ALPHABET_.indexOf(character)==-1)return false};return true},isShort=OpenLocationCode.isShort=function(code){if(!isValid(code))return false;if(code.indexOf(SEPARATOR_)>=0&&code.indexOf(SEPARATOR_)<SEPARATOR_POSITION_)return true;return false},isFull=OpenLocationCode.isFull=function(code){if(!isValid(code))return false;if(isShort(code))return false;var firstLatValue=CODE_ALPHABET_.indexOf(code.charAt(0).toUpperCase())*ENCODING_BASE_;if(firstLatValue>=LATITUDE_MAX_*2)return false;if(code.length>1){var firstLngValue=CODE_ALPHABET_.indexOf(code.charAt(1).toUpperCase())*ENCODING_BASE_;if(firstLngValue>=LONGITUDE_MAX_*2)return false};return true},decode=OpenLocationCode.decode=function(code){if(!isFull(code))throw('IllegalArgumentException: Passed Open Location Code is not a valid full code: '+code);code=code.replace(SEPARATOR_,'');code=code.replace(new RegExp(PADDING_CHARACTER_+'+'),'');code=code.toUpperCase();var codeArea=decodePairs(code.substring(0,PAIR_CODE_LENGTH_));if(code.length<=PAIR_CODE_LENGTH_)return codeArea;var gridArea=decodeGrid(code.substring(PAIR_CODE_LENGTH_,MAX_DIGIT_COUNT));return CodeArea(codeArea.latitudeLo+gridArea.latitudeLo,codeArea.longitudeLo+gridArea.longitudeLo,codeArea.latitudeLo+gridArea.latitudeHi,codeArea.longitudeLo+gridArea.longitudeHi,codeArea.codeLength+gridArea.codeLength)},recoverNearest=OpenLocationCode.recoverNearest=function(shortCode,referenceLatitude,referenceLongitude){if(!isShort(shortCode))if(isFull(shortCode)){return shortCode}else throw'ValueError: Passed short code is not valid: '+shortCode;referenceLatitude=Number(referenceLatitude);referenceLongitude=Number(referenceLongitude);if(isNaN(referenceLatitude)||isNaN(referenceLongitude))throw('ValueError: Reference position are not numbers');referenceLatitude=clipLatitude(referenceLatitude);referenceLongitude=normalizeLongitude(referenceLongitude);shortCode=shortCode.toUpperCase();var paddingLength=SEPARATOR_POSITION_-shortCode.indexOf(SEPARATOR_),resolution=Math.pow(20,2-(paddingLength/2)),halfResolution=resolution/2.0,codeArea=decode(encode(referenceLatitude,referenceLongitude).substr(0,paddingLength)+shortCode);if(referenceLatitude+halfResolution<codeArea.latitudeCenter&&codeArea.latitudeCenter-resolution>=-LATITUDE_MAX_){codeArea.latitudeCenter-=resolution}else if(referenceLatitude-halfResolution>codeArea.latitudeCenter&&codeArea.latitudeCenter+resolution<=LATITUDE_MAX_)codeArea.latitudeCenter+=resolution;if(referenceLongitude+halfResolution<codeArea.longitudeCenter){codeArea.longitudeCenter-=resolution}else if(referenceLongitude-halfResolution>codeArea.longitudeCenter)codeArea.longitudeCenter+=resolution;return encode(codeArea.latitudeCenter,codeArea.longitudeCenter,codeArea.codeLength)},clipLatitude=function(latitude){return Math.min(90,Math.max(-90,latitude))},computeLatitudePrecision=function(codeLength){if(codeLength<=10)return Math.pow(20,Math.floor(codeLength/-2+2));return Math.pow(20,-3)/Math.pow(GRID_ROWS_,codeLength-10)},normalizeLongitude=function(longitude){while(longitude<-180)longitude=longitude+360;while(longitude>=180)longitude=longitude-360;return longitude},decodePairs=function(code){var latitude=decodePairsSequence(code,0),longitude=decodePairsSequence(code,1);return new CodeArea(latitude[0]-LATITUDE_MAX_,longitude[0]-LONGITUDE_MAX_,latitude[1]-LATITUDE_MAX_,longitude[1]-LONGITUDE_MAX_,code.length)},decodePairsSequence=function(code,offset){var i=0,value=0;while(i*2+offset<code.length){value+=CODE_ALPHABET_.indexOf(code.charAt(i*2+offset))*PAIR_RESOLUTIONS_[i];i+=1};return[value,value+PAIR_RESOLUTIONS_[i-1]]},decodeGrid=function(code){var latitudeLo=0.0,longitudeLo=0.0,latPlaceValue=GRID_SIZE_DEGREES_,lngPlaceValue=GRID_SIZE_DEGREES_,i=0;while(i<code.length){var codeIndex=CODE_ALPHABET_.indexOf(code.charAt(i)),row=Math.floor(codeIndex/GRID_COLUMNS_),col=codeIndex%GRID_COLUMNS_;latPlaceValue/=GRID_ROWS_;lngPlaceValue/=GRID_COLUMNS_;latitudeLo+=row*latPlaceValue;longitudeLo+=col*lngPlaceValue;i+=1};return CodeArea(latitudeLo,longitudeLo,latitudeLo+latPlaceValue,longitudeLo+lngPlaceValue,code.length)},CodeArea=OpenLocationCode.CodeArea=function(latitudeLo,longitudeLo,latitudeHi,longitudeHi,codeLength){return new OpenLocationCode.CodeArea.fn.init(latitudeLo,longitudeLo,latitudeHi,longitudeHi,codeLength)};CodeArea.fn=CodeArea.prototype={init:function(latitudeLo,longitudeLo,latitudeHi,longitudeHi,codeLength){this.latitudeLo=latitudeLo;this.longitudeLo=longitudeLo;this.latitudeHi=latitudeHi;this.longitudeHi=longitudeHi;this.codeLength=codeLength;this.latitudeCenter=Math.min(latitudeLo+(latitudeHi-latitudeLo)/2,LATITUDE_MAX_);this.longitudeCenter=Math.min(longitudeLo+(longitudeHi-longitudeLo)/2,LONGITUDE_MAX_)}};CodeArea.fn.init.prototype=CodeArea.fn;return OpenLocationCode}));input=prompt("Enter OLC:");location.href="https://www.openstreetmap.org/search?query="+OpenLocationCode.decode(input).latitudeCenter+",%20"+OpenLocationCode.decode(input).longitudeCenter
